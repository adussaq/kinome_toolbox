!function(e){"use strict";var t,i,n,a,r,l,s,o,c=!1,p={},u=[require("img-picker"),require("equation-picker")];a=function(e,t){var n=KINOME.imagePicker(t),a=KINOME.equationPicker(t,n);n.disableCycle(),o=t,p.figures=$("<div>",{class:"row"}),p.kinetic={},p.kinetic.picker=$("<div>",{class:"col col-sm-6 col-xs-12"}),p.kinetic.figure=$("<div>",{class:"col col-sm-6 col-xs-12"}),p.correlation=$("<p>",{style:"margin-top: 10px;",class:"text-center lead"}),p.figures.append(p.kinetic.picker).append(p.kinetic.figure),p.allTog=$('<input type="checkbox" data-on="All Samples" data-off="One Sample" data-width="125" data-toggle="toggle">'),p.kinetic.picker.append('<div height="15px;">&nbsp;</div>').append(p.allTog).append(a.col.kinetic).append(p.correlation),p.allTog.bootstrapToggle().change(function(){c=$(this).prop("checked"),l(i)}),e.append(n.div).append(p.figures),p.width=$("<div>",{class:"col col-sm-6 col-xs-12"}),p.width.appendTo($("<div>",{class:"row"}).appendTo($("<div>",{class:"container",style:"height:0px;visibility: hidden;"}).appendTo("body"))),a.change(l)},l=function(e){i=e,s(e,"kinetic","exposure")},s=function(e,i,a){var l=r(e,i,a),s=google.visualization.arrayToDataTable(l),o={title:"Measurement Reproducibility",titleTextStyle:{fontName:'"Helvetica Neue", Helvetica, Arial, sans-serif',bold:!1,fontSize:"24"},hAxis:{title:"Cycle Series "+e.eq.kinetic.parameter,titleTextStyle:{fontName:'"Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:"20",bold:!1},textStyle:{fontName:'"Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:"14"}},vAxis:{title:e[a]+(Number.isInteger(1*e[a])?" ms ":" ")+e.eq.kinetic.parameter,titleTextStyle:{fontName:'"Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:"20",bold:!1},textStyle:{fontName:'"Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:"14"}},legend:"none",seriesType:"scatter",series:{4:{color:"#e2431e",type:"line",enableInteractivity:!1}},height:p.width.width(),width:p.width.width()},c=new google.visualization.ComboChart(p.kinetic.figure[0]);google.visualization.events.addListener(c,"ready",function(){$.each($("text"),function(e,t){var i=$(t).text();return i.match(/_|\^/)&&(i=(i=i.replace(/_([^\{])|_\{([^\}]*)\}/g,'<tspan style="font-size: smaller;" baseline-shift="sub">$1$2</tspan>')).replace(/\^([^\{])|\^\{([^\}]*)\}/g,'<tspan style="font-size: smaller;" baseline-shift="super">$1$2</tspan>'),$(t).html(i)),e})}),c.draw(s,o),p.correlation.html("<span>Pearson's r = "+t(l).toFixed(4)+";</span> <span>Spearman's &rho; = "+n(l).toFixed(4)+"</span>")},r=function(e,t,i){var n,a,r,l,s;return s=c?o:e.sample,n={type:t},n[i]="Cycle Slope",a=s.get(n),a=a.map(function(i){return e.eq[t].eval(i,"Cycle Slope")}),n={type:t},n[i]=e[i],r=s.get(n),(l=r.map(function(i,n){return[a[n],e.eq[t].eval(i)]})).unshift(["X","Y"]),l},n=function(){var e=function(e,t){return e[0]-t[0]};return function(i){var n,a=[],r=[],l=[],s=0;for(i.map(function(e){e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),"number"==typeof e[0]&&!isNaN(e[0])&&"number"==typeof e[1]&&!isNaN(e[1])&&isFinite(e[0])&&isFinite(e[1])&&(a.push([e[0],s]),r.push([e[1],s]),s+=1)}),a=a.sort(e),r=r.sort(e),n=0;n<a.length;n+=1)l[a[n][1]]=l[a[n][1]]||[],l[r[n][1]]=l[r[n][1]]||[],l[a[n][1]][0]=n,l[r[n][1]][1]=n;return t(l)}}(),t=function(){var e,t,i,n;return e=function(e,t){return[e[0]+t[0],e[1]+t[1]]},t=function(e){return[e[0]*e[0],e[1]*e[1]]},i=function(e){return e[0]*e[1]},n=function(e,t){return e+t},function(a){var r=0,l=[];for(r=0;r<a.length;r+=1)a[r][0]=parseFloat(a[r][0]),a[r][1]=parseFloat(a[r][1]),"number"==typeof a[r][0]&&!isNaN(a[r][0])&&"number"==typeof a[r][1]&&!isNaN(a[r][1])&&isFinite(a[r][0])&&isFinite(a[r][1])&&l.push([a[r][0],a[r][1]]);if(!l.length)return 0;var s=l.reduce(e),o=l.map(t).reduce(e),c=l.map(i).reduce(n),p=l.length,u=c-s[0]*s[1]/p,f=Math.sqrt((o[0]-s[0]*s[0]/p)*(o[1]-s[1]*s[1]/p));return 0===f?0:u/f}}(),Promise.all(u).then(function(){var e=KINOME.get({level:"^2"});if(e.length>0&&e.get({exposure:"Cycle Series"}).length>0){var t=KINOME.addAnalysis("Measurement Reproducibility");a(t,e)}})}(KINOME);