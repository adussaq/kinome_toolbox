!function(){"use strict";var e,a,t,n,p,r,o,l,i,d=KINOME.page;a=function(){return KINOME.params.data.map(function(e){return e.value.map(function(e){return{names:[e],url:e.data_origin_url}})}).reduce(function(e,a){return e.concat(a)})},t=function(e){var a,t,n,p,r,o=[],l={},i={};for(a=0;a<e.length;a+=1)for(t=0;t<e[a].names.length;t+=1){for(p=e[a].names[t],r={url:e[a].url,database:{},table:{}},r.table.name=p.name,r.table.group=void 0,r.table.id=p._id,n=0;n<p.sample_data.length;n+=1)r.database[p.sample_data[n].name]=p.sample_data[n].value,l[p.sample_data[n].name]=1;for(n=0;n<p.machine_data.length;n+=1)r.database[p.machine_data[n].name]=p.machine_data[n].value,i[p.machine_data[n].name]=1;o.push(r)}return{data:o,header:Object.keys(l),possible:Object.keys(i),header_options:Object.keys(l).concat(Object.keys(i)).map(function(e){return $('<option value="'+e+'">'+e+"</option>")})}},n=function(e){for(var a,t=e.header,n=e.possible;t.length>3;)t.pop();for(a=0;a<n.length&&t.length<3;a+=1)t.push(n[a]);for(a=0;a<t.length;a+=1)t[a]=[t[a],new RegExp("","i")];return t},p=function(a){var t,n,p,r,l,i;for(i=function(a){return function(t){var n=t.target.value;e.header[a][0]=n,o()}},t=$("<tr>").appendTo(a),t.append("<th>Analysis<br />Group</th>"),t.append("<th>Barcode, Row</th>"),p=0;p<e.header.length;p+=1){for(n=$("<th>").appendTo(t),n=$("<select>",{class:"form-control"}).appendTo(n),r=0;r<e.header_options.length;r+=1)l=e.header_options[r].clone(),l.text()===e.header[p][0]&&l.attr("selected","selected"),n.append(l);n.change(i(p))}},r=function(a){var t,n,p,r;for(p=function(a){return function(t){-2===a?e.group_filter=new RegExp(t.target.value,"i"):-1===a?e.name_filter=new RegExp(t.target.value,"i"):e.header[a][1]=new RegExp(t.target.value,"i"),o()}},r=$("<tr>").appendTo(a),t=-2;t<e.header.length;t+=1)n=$("<th>").appendTo(r),n=$("<input>",{type:"text",class:"form-control"}).appendTo(n),t>-2?n.attr("placeholder","regex filter"):n.css("max-width","60px"),n.keyup(p(t))},l=function(){var a,t;return t=$("<div>",{class:"text-center"}).appendTo(d),t=$('<nav aria-label="Page navigation"></nav>').appendTo(t),t=$('<ul class="pagination pagination-lg"></ul>').appendTo(t),$('<a href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>').click(function(a){a.preventDefault(),e.page=0===e.page?0:e.page-1,o()}).appendTo($("<li>").appendTo(t)),a=$('<a style="color: black" href="#"></a>').click(function(e){e.preventDefault()}).appendTo($("<li>").appendTo(t)),$('<a href="#" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>').click(function(a){a.preventDefault(),e.page+=1,o()}).appendTo($("<li>").appendTo(t)),a},i=function(a){var t,n,p,r,o,l,i;for(i=e.link_out,i.empty(),o="",t=0;t<a.length;t+=1){for(o+="data=*[",r={},n=0;n<a[t].length;n+=1)r[a[t][n].url]=r[a[t][n].url]||[],r[a[t][n].url].push(a[t][n].table.id);for(l=Object.keys(r),n=0;n<l.length;n+=1){for(o+=l[n].replace("names","<database>")+'?find={"names_id":{"$in":["',p=0;p<r[l[n]].length;p+=1)o+=r[l[n]][p]+'","';o=o.replace(/,"$/,"]}};")}o=o.replace(/;$/,"]*&")}o=o.replace(/&$/,""),i.text(o)},o=function(){var a,t,n,p,r,l,d,u,c,s,g,h,f,m,b,v,_,T,x;for(p=e.element,r=e.page,m=e.name_filter,_=e.group_filter,l=e.entries_per_page,d=e.data,u=e.header,s=-1,v="",x=[],p.empty(),c=function(a){return function(t){e.data[a].table.group=t.target.value,o()}},t=0;t<d.length;t+=1)d[t].table.group&&(x[d[t].table.group]=x[d[t].table.group]||[],x[d[t].table.group].push(d[t]),s=Math.max(s,d[t].table.group));for(s+=1,i(x),n=0,g=0,T=0;g<d.length;){for(h=!0,h&&!v.match(_)&&(d[g].table.group&&d[g].table.group.match(_)||(h=!1)),h&&!d[g].table.name.match(m)&&(h=!1),t=0;h&&t<u.length;t+=1)f=d[g].database[u[t][0]]||"",f.match(u[t][1])||(h=!1);if(h&&(T+=1)>r*l&&n<l){for(n+=1,a=$("<tr>").appendTo(p),b=$("<td>").appendTo(a),b=$("<select>",{class:"form-control"}).appendTo(b),b.append("<option selected value>None</option>"),t=0;t<=s;t+=1)1*d[g].table.group===t?b.append('<option selected="true" value="'+t+'">'+t+"</option>"):b.append('<option value="'+t+'">'+t+"</option>");for(b.change(c(g)),b=$("<td>",{text:d[g].table.name}).appendTo(a),t=0;t<u.length;t+=1)b=$("<td>").appendTo(a),f=d[g].database[u[t][0]]||"",b.text(f)}g+=1}e.pagination.text(e.page+1+" / "+Math.ceil(T/l)),n<1&&(e.page-=1,o())},function(){var i,u,c,s;i=a(),u=t(i),d.empty(),e={page:0,entries_per_page:8,name_filter:new RegExp("","i"),group_filter:new RegExp("","i")},e.data=u.data,e.header=n(u),e.header_options=u.header_options,u={},c=$("<table>",{class:"table"}).appendTo(d),s=$("<thead>").appendTo(c),p(s),r(s),e.element=$("<tbody>").appendTo(c),e.pagination=l(),e.link_out=$("<div>").appendTo(d),o()}()}();