!function(e){"use strict";var t,r,n,o,a,i,c,l,s,u,d,p;i=[require("enrich_kinome")],t=function(e){var t,r,n=decodeURIComponent(location.href),o=[];for(e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),r=(t=new RegExp("(?:[\\?&]"+e+'=")([^"]*)"',"g")).exec(n);r;)o.push(r[1]),r=t.exec(n);return o},s=function(e){var t,r,n,o=[];for(n=(r=new RegExp("data=\\*\\[([\\s\\S]+?)\\]\\*","g")).exec(e);n;)o.push(n[1]),n=r.exec(e);for(t=0;t<o.length;t+=1)o[t]=o[t].split(";");return o},p=function(e){return require(e,"style").catch(function(t){KINOME.error(t,"Failed to load style: "+e+".")})},l=function(e){return require(e,"json").then(function(t){var r,n,o,a=[];for(r=0;r<t.length;r+=1){for(o=t[r],Array.isArray(o)||(o=[o]),n=0;n<o.length;n+=1)Object.defineProperty(o[n],"data_origin_url",{enumerable:!1,configurable:!1,writable:!1,value:e[r]});o=KINOME.enrich(o),a=a.concat(o)}return a})},d=function(e){return function(){var t,r,n,o,a,i,c,l;return i=new Date-0,l=function(){return c.last=i,c.count+=1,window.localStorage[e]=JSON.stringify(c),!0},window.Storage&&window.localStorage[e]?(c=JSON.parse(window.localStorage[e]),(i-c.last>36e5||i-c.first>864e5)&&(c={first:i,last:i,count:0})):c={first:i,last:i,count:0},c.count>2?require(e).then(l).catch(function(t){KINOME.error(t,"Failed to load script: "+e+".")}):(o=new Promise(function(e,n){t=$("<div>",{class:"col col-md-6",style:"margin-left:auto; margin-right:auto;"}).append($("<button>",{class:"btn btn-info",html:"<span>Trust</span>"}).click(function(t){t.preventDefault(),a.alert("close"),e(!0)})),r=$("<div>",{class:"col col-md-6",style:"margin-left:auto; margin-right:auto;"}).append($("<button>",{class:"btn btn-danger",html:"<span>Reject</span>"}).click(function(e){e.preventDefault(),a.alert("close"),n("Script rejected by user.")}))}),n=$("<div>",{class:"row",html:'<div style="padding-top:1%; padding-bottom:1%" class="col col-xs-8 col-sm-10">Script tag loading is being used, for: "<a href="'+e+'">'+e+'</a>". This has loaded '+c.count+" times previously. Please ensure this is from a trusted source."}).append($("<div>",{class:"col-xs-4 col-sm-2"}).append($("<div>",{class:"row text-center"}).append(t).append(r))),a=KINOME.warn(n),o.then(function(){return require(e).then(l).catch(function(t){KINOME.error(t,"Failed to load script: "+e+".")})},function(e){console.error("Scirpt rejected by user",e)}))}},u=t("text"),c=t("style"),r=s(decodeURIComponent(location.href)),n=t("code"),e.params={},e.params.strings=[],e.params.data=[],e.params.script_urls=n,o=u.length?require(u,"text").then(function(t){var r=0;for(r=0;r<t.length;r+=1)e.params.strings[r]={value:t[r],url:u[r]}}):Promise.resolve(),c.length&&require(c,"style"),Promise.all(i).then(function(){(a=r.map(l).map(function(t,n){return t.then(function(t){e.params.data[n]={value:t,url:r[n]}}).catch(function(e){KINOME.error(e,"Failed to load one of the following data sets: "+r[n].join("<br />"))})})).push(o),Promise.all(a).then(function(){google.charts.setOnLoadCallback(function(){var e,t=Promise.resolve();for(e=0;e<n.length;e+=1)t=t.then(d(n[e]));t.then(require("webpage"))})})}),e.loadData=function(t){return Array.isArray(t)||(t=[t]),l(t).then(function(r){return r=r.map(function(e){return KINOME.enrich(e)}),e.params.data.push({value:r,url:t}),KINOME.enrich(r.map(function(e){return e}))})},e.loadStyle=p}("undefined"!=typeof module&&module.exports?module.exports:KINOME);