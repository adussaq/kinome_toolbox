!function(){"use strict";var e,a,t,n,r,p,o,l=KINOME.page;e=function(e){var a,t,n,r,p=[],o={},l={};for(a=0;a<e.length;a+=1){for(n=e[a],(r={url:e[a].url,database:{},table:{}}).table.name=n.name,r.table.group=void 0,r.table.id=n._id,t=0;t<n.sample_data.length;t+=1)r.database[n.sample_data[t].key]?r.database[n.sample_data[t].key]=[r.database[n.sample_data[t].key],n.sample_data[t].value]:(r.database[n.sample_data[t].key]=n.sample_data[t].value,o[n.sample_data[t].key]=1);for(t=0;t<n.run_data.length;t+=1)r.database[n.run_data[t].key]?r.database[n.run_data[t].key]=[r.database[n.run_data[t].key],n.run_data[t].value]:(r.database[n.run_data[t].key]=n.run_data[t].value,l[n.run_data[t].key]=1);p.push(r)}return{data:p,header:Object.keys(o),possible:Object.keys(l),header_options:Object.keys(o).concat(Object.keys(l)).map(function(e){return $('<option value="'+e+'">'+e+"</option>")})}},a=function(e){for(var a,t=e.header,n=e.possible;t.length>3;)t.pop();for(a=0;a<n.length&&t.length<3;a+=1)t.push(n[a]);for(a=0;a<t.length;a+=1)t[a]=[t[a],new RegExp("","i")];return t},t=function(e,a){var t,n,p,o,l,d;for(d=function(e){return function(t){var n=t.target.value;a.header[e][0]=n,r()}},(t=$("<tr>").appendTo(e)).append("<th>Analysis<br />Group</th>"),t.append("<th>Barcode, Row</th>"),p=0;p<a.header.length;p+=1){for(n=$("<th>").appendTo(t),p>0&&n.addClass("hidden-xs"),n=$("<select>",{class:"form-control"}).appendTo(n),o=0;o<a.header_options.length;o+=1)(l=a.header_options[o].clone()).text()===a.header[p][0]&&l.attr("selected","selected"),n.append(l);n.change(d(p))}},n=function(e,a){var t,n,p,o;for(p=function(e){return function(t){-2===e?a.group_filter=new RegExp(t.target.value,"i"):-1===e?a.name_filter=new RegExp(t.target.value,"i"):a.header[e][1]=new RegExp(t.target.value,"i"),r()}},o=$("<tr>").appendTo(e),t=-2;t<a.header.length;t+=1)n=$("<th>").appendTo(o),t>0&&n.addClass("hidden-xs"),n=$("<input>",{type:"text",class:"form-control"}).appendTo(n),t>-2?n.attr("placeholder","regex filter"):n.css("max-width","60px"),n.keyup(p(t))},p=function(e){var a,t;return t=$("<div>",{class:"text-center"}).appendTo(l),t=$('<nav aria-label="Page navigation"></nav>').appendTo(t),t=$('<ul class="pagination pagination-lg"></ul>').appendTo(t),$('<a href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>').click(function(a){a.preventDefault(),e.page=0===e.page?0:e.page-1,r()}).appendTo($("<li>").appendTo(t)),a=$('<a style="color: black" href="#"></a>').click(function(e){e.preventDefault()}).appendTo($("<li>").appendTo(t)),$('<a href="#" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>').click(function(a){a.preventDefault(),e.page+=1,r()}).appendTo($("<li>").appendTo(t)),a},o=function(e,a){var t,n,r,p,o,l,d;for((d=a.link_out).empty(),o="",t=0;t<e.length;t+=1){for(o+="data=*[",p={},n=0;n<e[t].length;n+=1)p[e[t][n].url]=p[e[t][n].url]||[],p[e[t][n].url].push(e[t][n].table.id);for(l=Object.keys(p),n=0;n<l.length;n+=1){for(o+=l[n].replace("names","<database>")+'?find={"names_id":{"$in":["',r=0;r<p[l[n]].length;r+=1)o+=p[l[n]][r]+'","';o=o.replace(/,"$/,"]}};")}o=o.replace(/;$/,"]*&")}o=o.replace(/&$/,""),d.text(o)},r=function(e,a){var t,n,p,l,d,i,s,u,g,c,h,f,b,v,m,_,y,T;for(l=a.element,d=a.page,v=a.name_filter,_=a.group_filter,i=a.entries_per_page,s=a.data,u=a.header,c=-1,"",T=[],l.empty(),g=function(e){return function(t){a.data[e].table.group=t.target.value,r()}},n=0;n<s.length;n+=1)s[n].table.group&&(T[s[n].table.group]=T[s[n].table.group]||[],T[s[n].table.group].push(s[n]),c=Math.max(c,s[n].table.group));for(c+=1,o(T,a),p=0,h=0,y=0;h<s.length;){for((f=!0)&&!"".match(_)&&(s[h].table.group&&s[h].table.group.match(_)||(f=!1)),f&&!s[h].table.name.match(v)&&(f=!1),n=0;f&&n<u.length;n+=1)b=s[h].database[u[n][0]]||"",Array.isArray(b)&&(b=b.join("\n")),b.match(u[n][1])||(f=!1);if(f&&(y+=1)>d*i&&p<i){if(p+=1,t=$("<tr>").appendTo(l),"name"===e){for(m=$("<td>").appendTo(t),(m=$("<select>",{class:"form-control"}).appendTo(m)).append("<option selected value>None</option>"),n=0;n<=c;n+=1)1*s[h].table.group===n?m.append('<option selected="true" value="'+n+'">'+n+"</option>"):m.append('<option value="'+n+'">'+n+"</option>");m.change(g(h))}else console.log(s[h].database.group),$("<td>").appendTo(t);for(m=$("<td>",{text:s[h].table.name}).appendTo(t),n=0;n<u.length;n+=1)m=$("<td>").appendTo(t),n>0&&m.addClass("hidden-xs"),b=s[h].database[u[n][0]]||"",Array.isArray(b)&&(b=b.length<4?b.join("<br/>"):"["+b.slice(0,3).join(b.slice(0,3).join("").length<20?", ":",<br/>")+", ...] ("+b.length+")"),m.html(b)}h+=1}a.pagination.text(a.page+1+" / "+Math.ceil(y/i)),p<1&&(a.page-=1,r())};var d=function(o,d){var i,s,u,g;i=e(o),l.empty(),(g={page:0,entries_per_page:8,name_filter:new RegExp("","i"),group_filter:new RegExp("","i")}).data=i.data,g.header=a(i),g.header_options=i.header_options,i={},s=$("<table>",{class:"table"}).appendTo(l),u=$("<thead>").appendTo(s),t(u,g),n(u,g),g.element=$("<tbody>").appendTo(s),g.pagination=p(g),g.link_out=$("<div>").appendTo(l),r(d,g)},i=KINOME.list({level:"name"});i.length&&d(i,"name");var s=KINOME.list({level:"1.0.1"});s.length&&d(s)}();