!function(){"use strict";var e,a,t,n,l,p,o,r=KINOME.page;e=function(e){var a,t,n,l,p=[],o={},r={};for(a=0;a<e.length;a+=1){for(n=e[a],(l={url:e[a].data_origin_url,database:{},table:{}}).table.name=n.name,l.table.group=void 0,l.table.id=n.name_id,l.origin_db=n,t=0;t<n.sample_data.length;t+=1)l.database[n.sample_data[t].key]?l.database[n.sample_data[t].key]=[l.database[n.sample_data[t].key],n.sample_data[t].value]:(l.database[n.sample_data[t].key]=n.sample_data[t].value,o[n.sample_data[t].key]=1);for(t=0;t<n.run_data.length;t+=1)l.database[n.run_data[t].key]?l.database[n.run_data[t].key]=[l.database[n.run_data[t].key],n.run_data[t].value]:(l.database[n.run_data[t].key]=n.run_data[t].value,r[n.run_data[t].key]=1);p.push(l)}return{data:p,header:Object.keys(o),possible:Object.keys(r),header_options:Object.keys(o).concat(Object.keys(r)).map(function(e){return $('<option value="'+e+'">'+e+"</option>")})}},a=function(e){for(var a,t=e.header,n=e.possible;t.length>3;)t.pop();for(a=0;a<n.length&&t.length<3;a+=1)t.push(n[a]);for(a=0;a<t.length;a+=1)t[a]=[t[a],new RegExp("","i")];return t},t=function(e,a){var t,n,p,o,r,d;for(d=function(e){return function(t){var n=t.target.value;a.header[e][0]=n,l(a)}},(t=$("<tr>").appendTo(e)).append("<th>Analysis<br />Group</th>"),t.append("<th>Barcode, Row</th>"),p=0;p<a.header.length;p+=1){for(n=$("<th>").appendTo(t),p>0&&n.addClass("hidden-xs"),n=$("<select>",{class:"form-control"}).appendTo(n),o=0;o<a.header_options.length;o+=1)(r=a.header_options[o].clone()).text()===a.header[p][0]&&r.attr("selected","selected"),n.append(r);n.change(d(p))}},n=function(e,a){var t,n,p,o;for(p=function(e){return function(t){-2===e?a.group_filter=new RegExp(t.target.value,"i"):-1===e?a.name_filter=new RegExp(t.target.value,"i"):a.header[e][1]=new RegExp(t.target.value,"i"),l(a)}},o=$("<tr>").appendTo(e),t=-2;t<a.header.length;t+=1)n=$("<th>").appendTo(o),t>0&&n.addClass("hidden-xs"),n=$("<input>",{type:"text",class:"form-control"}).appendTo(n),t>-2?n.attr("placeholder","regex filter"):n.css("max-width","60px"),n.keyup(p(t))},p=function(e){var a,t;return t=$("<div>",{class:"text-center"}).appendTo(r),t=$('<nav aria-label="Page navigation"></nav>').appendTo(t),t=$('<ul class="pagination pagination-lg"></ul>').appendTo(t),$('<a href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>').click(function(a){a.preventDefault(),e.page=0===e.page?0:e.page-1,l(e)}).appendTo($("<li>").appendTo(t)),a=$('<a style="color: black" href="#"></a>').click(function(e){e.preventDefault()}).appendTo($("<li>").appendTo(t)),$('<a href="#" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>').click(function(a){a.preventDefault(),e.page+=1,l(e)}).appendTo($("<li>").appendTo(t)),a},o=function(e,a){var t,n,l,p,o,r,d,i,s,u,g=["name","lvl_1.0.0","lvl_1.0.1","lvl_1.1.2","lvl_2.0.1","lvl_2.1.2"];for((d=a.link_out).empty(),o="",t=0;t<e.length;t+=1){for(o+="?data=*[",p={},n=0;e[t]&&n<e[t].length;n+=1)p[e[t][n].url]=p[e[t][n].url]||[],p[e[t][n].url].push(e[t][n].table.id);for(r=Object.keys(p),n=0;n<r.length;n+=1){for(o+=r[n].replace(/\/*\?[\s\S]*$|\/$/g,"").replace(/\/[^\/]+$/,"/<database>")+'?find={"name_id":{"$in":["',l=0;l<p[r[n]].length;l+=1)o+=p[r[n]][l]+'","';o=o.replace(/,"$/,"]}};")}o=o.replace(/;$/,""),o+="]*&"}if(o=o.replace(/&$/,""),e.length>0)for(d.append('<h1 class="page-header">Collections Possible</h1>'),u=$("<div>",{class:"row",style:"margin-bottom:20px;"}).appendTo(d),i=$("<ul>").appendTo($("<div>",{class:"col col-xs-6"}).appendTo(u)),s=$("<ul>").appendTo($("<div>",{class:"col col-xs-6"}).appendTo(u)),t=0;t<g.length;t+=1)t<Math.ceil(g.length/2)?i.append('<li><a href="'+o.replace(/<database>/g,g[t]).replace(/\"/g,"%22")+'">'+g[t]+"</a></li>"):s.append('<li><a href="'+o.replace(/<database>/g,g[t]).replace(/\"/g,"%22")+'">'+g[t]+"</a></li>")},l=function(e){var a,t,n,p,r,d,i,s,u,g,c,h,f,b,v,_,m,y;for(p=e.element,r=e.page,b=e.name_filter,_=e.group_filter,d=e.entries_per_page,i=e.data,s=e.header,g=-1,"",y=[],p.empty(),u=function(a){return function(t){e.data[a].table.group=t.target.value,l(e)}},t=0;t<i.length;t+=1)void 0!==i[t].table.group&&i[t].table.group.toString().match(/\d+/)&&(y[i[t].table.group]=y[i[t].table.group]||[],y[i[t].table.group].push(i[t]),g=Math.max(g,i[t].table.group));for(g+=1,o(y,e),n=0,c=0,m=0;c<i.length;){for((h=!0)&&!"".match(_)&&(void 0!==i[c].table.group&&i[c].table.group.toString().match(_)||(h=!1)),h&&!i[c].table.name.match(b)&&(h=!1),t=0;h&&t<s.length;t+=1)f=i[c].database[s[t][0]]||"",Array.isArray(f)&&(f=f.join("\n")),f.match(s[t][1])||(h=!1);if(h&&(m+=1)>r*d&&n<d){if(n+=1,a=$("<tr>").appendTo(p),"name"===e.table_type){for(v=$("<td>").appendTo(a),v=$("<select>",{class:"form-control"}).appendTo(v),void 0!==i[c].table.group&&i[c].table.group.toString().match(/\d{1,}/)?v.append('<option value="">None</option>'):v.append('<option selected="true" value>None</option>'),t=0;t<=g;t+=1)parseFloat(i[c].table.group)===t?v.append('<option selected="true" value="'+t+'">'+t+"</option>"):v.append('<option value="'+t+'">'+t+"</option>");v.change(u(c))}else $("<td>",{text:i[c].table.group}).appendTo(a);for(v=$("<td>",{text:i[c].table.name}).appendTo(a),t=0;t<s.length;t+=1)v=$("<td>").appendTo(a),t>0&&v.addClass("hidden-xs"),f=i[c].database[s[t][0]]||"",Array.isArray(f)&&(f=f.length<4?f.join("<br/>"):"["+f.slice(0,3).join(f.slice(0,3).join("").length<20?", ":",<br/>")+", ...] ("+f.length+")"),v.html(f)}c+=1}e.pagination.text(e.page+1+" / "+Math.ceil(m/d)),n<1&&(e.page-=1,l(e))};var d=function(o,d){var i,s,u,g,c;if(s=e(o),r.empty(),c={page:0,entries_per_page:8,name_filter:new RegExp("","i"),group_filter:new RegExp("","i")},c.data=s.data,c.header=a(s),c.header_options=s.header_options,s={},r.append("<h1>Sample List for level: "+d+"</h1>"),"name"===d)r.append("<p>Add samples to groups for reproducibility and comparisons then click the links below to load the different level data in a new window.</p>");else for(i=0;i<c.data.length;i+=1)c.data[i].table.group=c.data[i].origin_db.group;u=$("<table>",{class:"table"}).appendTo(r),g=$("<thead>").appendTo(u),t(g,c),n(g,c),c.element=$("<tbody>").appendTo(u),c.pagination=p(c),c.link_out=$("<div>").appendTo(r),c.table_type=d,l(c)};KINOME.list("levels").map(function(e){var a=KINOME.get({level:e});a.length&&d(a,e)})}();