!function(){"use strict";var n,r;n=function(){var n,r,t,e,a,u,o;return r=function(n){var r=0,t=0,e=0,a=n.length,u=0,o=[],f=[];if(n.length!==n[0].length)return null;for(r=0;r<a;r+=1)for(o[o.length]=[],f[f.length]=[],e=0;e<a;e+=1)o[r][e]=r===e?1:0,f[r][e]=n[r][e];for(r=0;r<a;r+=1){if(0===(u=f[r][r])){for(t=r+1;t<a;t+=1)if(0!==f[t][r]){for(e=0;e<a;e+=1)u=f[r][e],f[r][e]=f[t][e],f[t][e]=u,u=o[r][e],o[r][e]=o[t][e],o[t][e]=u;break}if(0===(u=f[r][r]))return null}for(e=0;e<a;e+=1)f[r][e]=f[r][e]/u,o[r][e]=o[r][e]/u;for(t=0;t<a;t+=1)if(t!==r)for(u=f[t][r],e=0;e<a;e+=1)f[t][e]-=u*f[r][e],o[t][e]-=u*o[r][e]}return o},t=function(n){return n[0].map(function(r,t){return n.map(function(n){return n[t]})})},a=function(n){var r,t,e=!0;for(r=0;r<n.length;r+=1){if(n[r][r].toFixed(5)!==1..toFixed(5)){e=!1;break}for(t=0;t<n.length;t+=1)if(r!==t&&Math.abs(n[r][t]).toFixed(5)!==(0).toFixed(5)){e=!1;break}}return e},e=function(n,r){var t,e,a,u,o=[];for(t=0;t<n.length;t+=1)for(o[t]=[],e=0;e<r[0].length;e+=1){for(u=0,a=0;a<n[0].length;a+=1)u+=n[t][a]*r[a][e];o[t][e]=u}return o},n=function(n){var r,t,e,a=[],u=n.length,o=1<<u;for(t=1;t<o;t+=1){for(r=[],e=0;e<u;e+=1)t&1<<e&&r.push(n[e]);a.push(r)}return a.sort(function(n,r){return r.length-n.length})},o=function(r,t){var e,a,o,f,i,c,l,p,h=[],s=[];for(e=0;e<r[0].length-1;e+=1)h.push(e);for(i=(h=n(h))[0].length,e=0;e<h.length;e+=1){for(i=h[e].length,f=[],a=0;a<r.length;a+=1)for(f[a]=[],o=0;o<i;o+=1)f[a].push(r[a][h[e][o]]);if(c=u(f,t,!1)){for(p=-1,o=0;o<i;o+=1){for(;h[e][o]!==p+1;)c.params.splice(p+1,0,0),p+=1;p+=1}for(o=p+1;o<r[0].length-1;o+=1)c.params.splice(o,0,0)}s.push(c)}for(l={ret:!1,val:0},e=0;e<s.length;e+=1)s[e]&&s[e].R2>l.val&&(l.val=s[e].R2,l.ret=s[e]);return l.ret},u=function(n,u,f){var i,c,l,p,h,s,g,m,d=0,v=0,N=0;return void 0===f&&(f=!0),n=n.map(function(n){return n.concat(1)}),m=u.map(function(n){return d+=n,[n]}),d/=m.length,l=e(t(n),n),(p=r(l))&&a(e(p,l))&&a(e(l,p))?(h=e(p,t(n)),c=e(h,m),s=c.map(function(n){return n[0]}),g=n.map(function(n,r){var t,e=0;for(t=0;t<n.length;t+=1)e+=n[t]*s[t];return v+=Math.pow(m[r][0]-d,2),N+=e-n[0]*s[0]-m[r][0],Math.pow(m[r][0]-e,2)}).reduce(function(n,r){return n+r}),i=1-g/v,{params:s,R2:1-g/v,shift:N/m.length,mean_y:d,adj_R2:1-(1-i)*(n.length-1)/(n.length-n[0].length-2)}):!!f&&o(n,u)}}(),r=function(){var r,t,e,a,u;return e=function(n,r){return 1*n-1*r},r=function(n,r,t){var a,u,o,f,i,c,l,p,h,s,g,m={},d=[],v=[],N=[];for(o=0;o<n.length;o+=1)for(f=0;f<n[o].length;f+=1){for(s=!0,(isNaN(n[o][f])||isNaN(r[o][f]))&&(s=!1),m={0:{value:n[o][f],count:1}},a=-1;a<2;a+=1)for(u=-1;u<2;u+=1)l=o+a,p=f+u,(i=a*a+u*u)&&r.hasOwnProperty(l)&&r[l].hasOwnProperty(p)&&(m[i]=m[i]||{value:0,count:0},isNaN(r[l][p])?s=!1:(m[i].value+=r[l][p],m[i].count+=1));for(h=Object.keys(m).sort(e),c=[],g=!0,a=0;g&&a<h.length;a+=1)m[h[a]].count?c.push(m[h[a]].value/m[h[a]].count):0===a?c.push(NaN):g=!1;s&&(d.push(c),v.push(r[o][f])),g&&N.push({data:c.concat(1),peptide:t[o][f]})}return{X:d,y:v,all:N}},u=function(n,r,t){var e,a,u,o=[];for(a=0;a<n.length;a+=1){for(e=t,u=1;u<r.length;u+=1)e+=r[u]*n[a].data[u];o.push({background:e,peptide:n[a].peptide})}return o},t=function(n,r){return isNaN(n)?r:isNaN(r)?n:Math.min(n,r)},a=function(n){return parseFloat(n)},function(e,o,f){var i,c,l;return e=e.map(function(n){return n.map(a)}),o=o.map(function(n){return n.map(a)}),c=Math.min(e.map(function(n){return n.reduce(t)}).reduce(t),o.map(function(n){return n.reduce(t)}).reduce(t))-1,e=e.map(function(n){return n.map(function(n){return n-c})}),o=o.map(function(n){return n.map(function(n){return n-c})}),i=r(e,o,f),i.y.length>5?(l=n(i.X,i.y),{data:u(i.all,l.params,c),params:l.params,R2:l.R2}):{data:[],params:[],R2:0}}}(),self.onmessage=function(n){var t=r(n.data.signal,n.data.background,n.data.name);self.postMessage({backgrounds:t.data,model_params:t.params,model_R2:t.R2,cycle:n.data.cycle,exposure:n.data.exposure})}}();